const canvas=document.getElementById("bg-canvas");if(canvas){const e=canvas.getContext("2d");let n;canvas.width=window.innerWidth,canvas.height=window.innerHeight;class i{constructor(){this.x=Math.random()*canvas.width,this.y=Math.random()*canvas.height,this.size=2*Math.random()+1,this.speedX=.5*(1.5*Math.random()-.75),this.speedY=.5*(1.5*Math.random()-.75),this.color="#00ff41"}update(){this.x+=this.speedX,this.y+=this.speedY,(this.x>canvas.width||this.x<0)&&(this.speedX=-this.speedX),(this.y>canvas.height||this.y<0)&&(this.speedY=-this.speedY)}draw(){e.fillStyle=this.color,e.beginPath(),e.arc(this.x,this.y,this.size,0,2*Math.PI),e.fill()}}const s=100;function init(){n=[];let e=Math.min(Math.floor(canvas.height*canvas.width/25e3),s);for(let t=0;t<e;t++)n.push(new i)}function animate(){e.clearRect(0,0,canvas.width,canvas.height);for(let t=0;t<n.length;t++){n[t].update(),n[t].draw();for(let i=t;i<n.length;i++){const s=n[t].x-n[i].x,a=n[t].y-n[i].y,o=Math.sqrt(s*s+a*a);o<150&&(e.beginPath(),e.strokeStyle=`rgba(0, 255, 65, ${1-o/150})`,e.lineWidth=.5,e.moveTo(n[t].x,n[t].y),e.lineTo(n[i].x,n[i].y),e.stroke())}}requestAnimationFrame(animate)}let a;window.addEventListener("resize",()=>{clearTimeout(a),a=setTimeout(()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight,init()},150)}),init(),animate()}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"===t)return;const n=document.querySelector(t);n&&(e.preventDefault(),n.scrollIntoView({behavior:"smooth"}))})});const API_BASE="https://9sec-smtp-backend.nine-security.workers.dev";function validateEmail(e){if("string"!=typeof e)return"Please enter a valid corporate email.";const t=e.trim();if(0===t.length)return"Please enter a valid corporate email.";if(t.length>254)return"Email address is too long.";if(/[\x00-\x1F\x7F]/.test(t))return"Invalid characters in email.";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return"Please enter a valid corporate email.";const n=t.split("@")[1];return!n||n.length<4?"Please enter a valid corporate email.":null}const ARTICLES_INITIAL=6,articlesSection=document.querySelector("#security-news"),articlesContainer=document.querySelector("#security-news .list-layout");let globalNewsList=[],newsShowingCount=6;function renderNews(e,t){if(!articlesContainer)return;newsShowingCount=t;const n=Math.min(t,e.length),i=e.slice(0,n);articlesContainer.innerHTML=i.map(e=>{const t=localStorage.getItem("9sec_lang")||"en",n="tw"===t?e.tw||e:"jp"===t?e.jp||e:e.en||e,i=e.is_ai?'<span class="ai-badge">AI Summary</span>':"";return`\n        <article class="list-item">\n            <div class="date">${escapeHtml(e.date||"")} ${i}</div>\n            <div class="content">\n                <h3>${escapeHtml(n.title||"")}</h3>\n                <p>${escapeHtml(n.excerpt||"")}</p>\n            </div>\n            <div class="action">\n                <a href="${escapeHtml(e.url||"#")}" class="read-btn" target="_blank" rel="noopener noreferrer">READ</a>\n            </div>\n        </article>\n        `}).join("");let s=articlesSection.querySelector(".articles-more-wrap");if(e.length>6){s||(s=document.createElement("div"),s.className="articles-more-wrap",articlesSection.querySelector(".container").appendChild(s));const t=n>=e.length,i=e.length-n,a=getArticlesButtonLabel(t,i);s.innerHTML=`<button type="button" class="articles-more-btn" data-expanded="${t}" data-remaining="${i}">${escapeHtml(a)}</button>`,s.querySelector("button").onclick=()=>{renderNews(e,t?6:e.length)}}else s&&s.remove()}articlesContainer&&articlesSection&&fetch(`${API_BASE}/api/articles`).then(e=>e.ok?e.json():[]).then(e=>{Array.isArray(e)&&0!==e.length&&(globalNewsList=e,renderNews(e,6))}).catch(()=>{});const THREAT_INTEL_CISA_INITIAL=8,THREAT_INTEL_OTX_INITIAL=5,threatIntelSection=document.querySelector("#threat-intel"),threatIntelContent=document.getElementById("threat-intel-content");function getThreatIntelHeadingCisa(){return t("threat_intel.heading_cisa","CISA KEV")}function getThreatIntelHeadingOtx(){return t("threat_intel.heading_otx","OTX Pulses")}function getThreatIntelButtonLabel(e,n){return e?t("threat_intel.collapse","Collapse"):t("threat_intel.show_more","Show more ({n})").replace("{n}",n)}function getThreatIntelEmptyLabel(){return t("threat_intel.empty","No threat intel entries yet.")}function getThreatIntelLoadErrorLabel(){return t("threat_intel.load_error","Unable to load threat intel.")}function getThreatIntelDetailLabel(){return t("threat_intel.detail","CVE")}function escapeHtml(e){if(null==e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function getStatusClass(e){if(null==e)return"fail";const t=String(e).toLowerCase();return["pass","true","low","enforce","enabled"].includes(t)?"pass":["warn","none","medium","missing","quarantine/none"].includes(t)?"warn":"fail"}threatIntelContent&&threatIntelSection&&fetch(`${API_BASE}/api/threat-intel`).then(e=>e.ok?e.json():[]).then(e=>{if(!Array.isArray(e)||0===e.length){const e=getThreatIntelEmptyLabel();return threatIntelContent.className="threat-intel-content threat-intel-placeholder",void(threatIntelContent.innerHTML=`<p class="placeholder-text">${escapeHtml(e)}</p>`)}const t=e.filter(e=>"otx"!==e.source),n=e.filter(e=>"otx"===e.source),i=getThreatIntelHeadingCisa(),s=getThreatIntelHeadingOtx();function a(e,t,n,i,s){let a=t;const o=t=>{a=t;const n=Math.min(t,e.length);return e.slice(0,n).map(e=>((e,t)=>{const n=localStorage.getItem("9sec_lang")||"en",i="tw"===n?e.tw||e:"jp"===n?e.jp||e:e.en||e,s=e.is_ai?'<span class="ai-badge ai-badge-small">AI</span>':"",a="high"===e.severity?'<span class="severity-badge severity-high" data-i18n="threat_intel.ransomware">Ransomware</span>':"",o=t?`<span class="source-badge source-${escapeHtml(e.source||"cisa")}" data-i18n="threat_intel.source_${"otx"===e.source?"otx":"cisa"}">${"otx"===e.source?"OTX":"CISA"}</span> `:"",r=getThreatIntelDetailLabel();return`\n                    <article class="list-item threat-intel-item">\n                        <div class="date">${o}${escapeHtml(e.date||"")} ${s}</div>\n                        <div class="content">\n                            <h3>${a}${escapeHtml(i.title||"")}</h3>\n                            <p>${escapeHtml(i.excerpt||"")}</p>\n                        </div>\n                        <div class="action">\n                            <a href="${escapeHtml(e.url||"#")}" class="read-btn" target="_blank" rel="noopener noreferrer">${escapeHtml(r)}</a>\n                        </div>\n                    </article>\n                `})(e,!1)).join("")},r=()=>{const l=a>=e.length?t:e.length,c=threatIntelSection.querySelector(`.${n}`),d=threatIntelSection.querySelector(`.${i}`);if(c&&(c.innerHTML=o(l)),d){const t=l>=e.length,n=e.length-Math.min(l,e.length);d.innerHTML=`<button type="button" class="articles-more-btn threat-intel-more-btn ${s}" data-expanded="${t}" data-remaining="${n}">${escapeHtml(getThreatIntelButtonLabel(t,n))}</button>`,d.querySelector("button").onclick=r}};return{render:o,buildBtn:(e,t)=>{const n=getThreatIntelButtonLabel(e,t);return`<div class="threat-intel-more-wrap ${i}"><button type="button" class="articles-more-btn threat-intel-more-btn ${s}" data-expanded="${e}" data-remaining="${t}">${escapeHtml(n)}</button></div>`},onClick:r,get showing(){return a}}}const o=a(t,8,"threat-intel-cisa-list","threat-intel-cisa-more","threat-intel-cisa-btn"),r=a(n,5,"threat-intel-otx-list","threat-intel-otx-more","threat-intel-otx-btn"),l=0===t.length?"":`<div class="threat-intel-group threat-intel-cisa">\n                    <h3 class="threat-intel-group-title" data-i18n="threat_intel.heading_cisa">${escapeHtml(i)}</h3>\n                    <div class="list-layout threat-intel-cisa-list">${o.render(o.showing)}</div>\n                    ${t.length>8?o.buildBtn(o.showing>=t.length,t.length-Math.min(o.showing,t.length)):""}\n                </div>`,c=0===n.length?"":`<div class="threat-intel-group threat-intel-otx">\n                    <h3 class="threat-intel-group-title" data-i18n="threat_intel.heading_otx">${escapeHtml(s)}</h3>\n                    <div class="list-layout threat-intel-otx-list">${r.render(r.showing)}</div>\n                    ${n.length>5?r.buildBtn(r.showing>=n.length,n.length-Math.min(r.showing,n.length)):""}\n                </div>`;threatIntelContent.className="threat-intel-content threat-intel-split"+(t.length&&n.length?" threat-intel-split-two":""),threatIntelContent.innerHTML=`<div class="threat-intel-split-inner">${l}${c}</div>`;const d=threatIntelSection.querySelector(".threat-intel-cisa-btn");d&&(d.onclick=o.onClick);const m=threatIntelSection.querySelector(".threat-intel-otx-btn");m&&(m.onclick=r.onClick)}).catch(()=>{const e=getThreatIntelLoadErrorLabel();threatIntelContent.className="threat-intel-content threat-intel-placeholder",threatIntelContent.innerHTML=`<p class="placeholder-text">${escapeHtml(e)}</p>`});const translations={en:{nav:{home:"/Home",services:"/Services",model:"/9SEC_Model",tools:"/Arsenal",news:"/Security_News",threat_intel:"/Threat_Intel",contact:"/Contact",back_to_services:"RETURN_TO_SERVICES"},hero:{init:"Initializing 9SEC Defense Protocol... <span class='status-ok'>[ACTIVE]</span>",title:"EVIDENCE-BASED SECURITY",subtitle:"Turning Incidents into Verifiable Defense Capabilities.",desc:"We provide security consulting centered on <strong>Forensics</strong> and <strong>Evidence</strong>. Through our unique <strong>9-Layer Defense Model</strong>, we help enterprises see the full attack picture and close defense gaps.",cta_model:"9-Layer Model",cta_arsenal:"Our Arsenal"},section:{model:"The_9SEC_Model",arsenal:"Operational_Arsenal",news:"Security_News",intelligence:"Threat_Intelligence",threat_intel_coming:"Threat intelligence feed will be integrated here.",smtp:"SMTP_Security_Check",dmarc_intel:"DMARC_Intelligence",services:"9SEC_SERVICES"},services:{subtitle:"Specialized Security Inspection & Forensic Probes",smtp_title:"SMTP Security Check",smtp_desc:"Verify your email infrastructure health. Checks SPF, DMARC, MTA-STS, and transport encryption. Now includes real-time brand impersonation and lookalike domain monitoring.",ad_title:"AD / Azure Identity Audit",ad_desc:"Scan for over-privileged accounts, shadow admins, and insecure authentication paths in your directory services.",edr_title:"Endpoint EDR Hygiene",edr_desc:"Identify gaps in EDR coverage and behavioral monitoring across your workstation fleet.",cta_launch:"LAUNCH_PROBE",limited_access:"LIMITED_ACCESS",coming_soon:"COMING_SOON",custom_probe:"Custom_Forensic_Probes",custom_desc:"Need a specialized inspection for a proprietary protocol or high-value asset? Our team builds custom forensic probes tailored to your environment.",cta_consult:"REQUEST_CUSTOM_AUDIT",dmarc_title:"DMARC Intelligence Monitor",dmarc_desc:"Professional-grade brand protection that goes beyond manual parsing. <ul><li><i class='fa-solid fa-check'></i> <strong>Consolidated Dashboard</strong>: Single portal for all your sending domains.</li><li><i class='fa-solid fa-check'></i> <strong>Continuous Tracking</strong>: 24/7 automated report collection via RUA.</li><li><i class='fa-solid fa-check'></i> <strong>Forensic Insights</strong>: Identify unauthorized spoofing attempts in real-time.</li></ul>",dmarc_trial_tag:"Free Manual Tool",dmarc_pro_title:"Switch to Automated Monitoring",dmarc_pro_desc:"Don't waste time on manual uploads. Our subscription tier offers hands-off automation and professional expert interpretation.",dmarc_benefit_automated:"<strong>Automated Pipeline</strong>: No manual file uploading needed.",dmarc_benefit_continuous:"<strong>24/7 Monitoring</strong>: We track your domain reputation around the clock.",dmarc_benefit_expert:"<strong>Expert Interpretation</strong>: We don't just show charts; we help you decode the forensic data.",dmarc_benefit_consolidated:"<strong>Unified Portal</strong>: Manage all domains in one dashboard."},model:{intro1:"> Beyond Protection. 9 Dimensions of Verifiable Truth.",intro2:"A practical framework covering Governance, Protection, Detection, Response, and Evolution.",l1_title:"Governance & Risk",l1_desc:"Building the correct security foundation from decision-making and risk perspectives.",l1_d1:"Policy & Responsibility",l1_d2:"Risk Assessment",l1_d3:"Compliance (ISO/NIST)",l2_title:"Identity & Access",l2_desc:"Minimizing initial intrusion and lateral movement risks.",l2_d1:"AD/IAM Architecture",l2_d2:"Over-Privilege Analysis",l2_d3:"MFA Strategies",l3_title:"Endpoint Protection",l3_desc:"Mastering actual attack execution and landing behavior.",l3_d1:"EDR/XDR Health Check",l3_d2:"Behavior Analysis",l3_d3:"Fileless Monitoring",l4_title:"Network Defense",l4_desc:"Identifying hidden communications and lateral movement.",l4_d1:"Traffic Analysis",l4_d2:"C2 Communication",l4_d3:"Lateral Movement Paths",l5_title:"Application & Cloud",l5_desc:"Securing the modern attack surface.",l5_d1:"Web/API Analysis",l5_d2:"Cloud Config Risks",l5_d3:"SaaS Access Review",l6_title:"Threat Intelligence",l6_desc:"Strengthening defense decisions from the adversary's perspective.",l6_d1:"APT Behavioral Analysis",l6_d2:"MITRE ATT&CK Mapping",l6_d3:"Threat Profiling",l7_title:"Detection Engineering",l7_desc:"Making defense capabilities quantifiable and verifiable.",l7_d1:"Rule Design & QA",l7_d2:"Attack Chain Coverage",l7_d3:"Gap Analysis",l8_title:"Incident Response & DFIR",l8_desc:"Restoring the full truth when incidents occur.",l8_d1:"Forensic Investigation",l8_d2:"Timeline Reconstruction",l8_d3:"Root Cause Analysis",l9_title:"Resilience & Evolution",l9_desc:"Transforming incidents into long-term defense capabilities.",l9_d1:"Post-Incident Review",l9_d2:"Process Optimization",l9_d3:"Evolution Roadmap"},footer:{tagline:"Securing the digital frontier.",copyright:"&copy; 2026 Nine-Security. All Systems Operational."},contact:{subtitle:"Connect with our Forensic Consultants",email_label:"Email_Channel",availability_label:"Duty_Status",availability_value:"24/7 Forensic Response",desc:"For custom audits, incident response, or forensic inquiries, please reach out via email. Our team typically responds within 4 standard operation hours."},smtp:{title:"Free Inbound Mail Security Assessment",desc:"Non-intrusive. Evidence-based. Checks MX health, encryption, and performs deep scans for lookalike domains used in phishing.",email_label:"Enter Work Email:",consent:"I authorize scanning of this domain's inbound MX.",btn_start:"Start Assessment",verify_title:"Verification Required",verify_desc:"To prove domain control, please send an empty email from your address to:",waiting:"Waiting for inbound email..."},articles:{show_more:"Show more ({n})",collapse:"Collapse"},news:{item1_title:"China-Linked DKnife AitM Framework Targets Routers",item1_desc:"Researchers uncover DKnife, a long-active AitM toolkit used by China-nexus actors to hijack edge device traffic.",item2_title:"CISA Orders Removal of Unsupported Edge Devices",item2_desc:"CISA directs federal agencies to replace end-of-life edge network devices to mitigate critical infrastructure risks.",item3_title:"Claude Opus 4.6 Finds 500+ High-Severity Flaws",item3_desc:"Anthropic reports Claude Opus 4.6 discovered over 500 unknown high-severity flaws in major open-source libraries."},threat_intel:{detail:"CVE",empty:"No threat intel entries yet.",load_error:"Unable to load threat intel.",ransomware:"Ransomware",source_cisa:"CISA",source_otx:"OTX",heading_cisa:"CISA KEV",heading_otx:"OTX Pulses",show_more:"Show more ({n})",collapse:"Collapse"},promo_modal:{title:"FREE SECURITY ASSESSMENT",desc:"Enhance your defense. Check your Email Security (SMTP/MX) status with our free forensic tool.",accept:"SCAN NOW",close:"CONTINUE BROWSING"},arsenal:{host_witness_title:"HostWitness",host_witness_desc:"Windows single-host live forensics and activity correlation tool. Collects and correlates processes, network, and timeline events.",host_witness_btn:"View on GitHub",host_witness_download:"Download .ZIP",host_witness_hash:"SHA-256 Checksum"},common:{notice_header:"SYSTEM_NOTIFICATION",notice_btn:"[ ACKNOWLEDGE ]"}},tw:{nav:{home:"/首頁",services:"/服務項目",model:"/九層防護模型",tools:"/軍火庫",news:"/資安新聞",threat_intel:"/威脅情資",contact:"/聯絡我們",back_to_services:"回到服務項目"},hero:{init:"正在初始化 9SEC 防護協定... <span class='status-ok'>[運作中]</span>",title:"證據導向資安防護",subtitle:"將資安事件轉化為可驗證的防禦能力",desc:"我們提供以 **鑑識 (Forensics)** 與 **證據 (Evidence)** 為核心的資安顧問服務。透過獨創的 **九層資安防護模型**，協助企業看清攻擊全貌並修補防禦缺口。",cta_model:"九層防護模型",cta_arsenal:"檢視軍火庫"},section:{model:"九層資安防護模型",arsenal:"作戰軍火庫",news:"資安新聞",intelligence:"威脅情資",threat_intel_coming:"威脅情資來源將整合於此。",smtp:"SMTP_安全檢測",dmarc_intel:"DMARC_智能分析",services:"9SEC_服務項目"},services:{subtitle:"專業安全檢測與鑑識探針",smtp_title:"SMTP 郵件安全檢測",smtp_desc:"驗證您的郵件基礎設施健康狀況。檢查 SPF、DMARC、MTA-STS 以及傳輸加密，現已整合即時品牌偽冒網域監控與情資分析。",ad_title:"AD / Azure 身分稽核",ad_desc:"掃描目錄服務中的過度權限帳戶、影子管理員以及不安全的驗證路徑。",edr_title:"端點 EDR 健康檢查",edr_desc:"識別端點 EDR 覆蓋範圍與行為監控在您工作站群中的缺口。",cta_launch:"啟動探測",limited_access:"權限受限",coming_soon:"即將推出",custom_probe:"客製化鑑識探針",custom_desc:"需要針對專有協定或高價值資產進行專門檢查嗎？我們的團隊可為您的環境量身打造客製化鑑識探針。",cta_consult:"申請客製化稽核",dmarc_title:"DMARC 智慧監控系統",dmarc_desc:"超越手動分析的專業級品牌保護。 <ul><li><i class='fa-solid fa-check'></i> <strong>單一整合儀表板</strong>：全域網域發信狀況一目瞭裝。</li><li><i class='fa-solid fa-check'></i> <strong>持續性自動追蹤</strong>：透過 RUA 進行每週 7x24 自動化報告採集。</li><li><i class='fa-solid fa-check'></i> <strong>鑑識級深度洞察</strong>：即時識別非法冒名發信來源與地理分佈。</li></ul>",dmarc_trial_tag:"免費試用工具",dmarc_pro_title:"升級至自動化全時監控",dmarc_pro_desc:"不再浪費時間手動上傳。訂閱方案提供全自動採集與專業資安專家解讀服務。",dmarc_benefit_automated:"<strong>全自動化管道</strong>：無需再手動處理 XML 檔案。",dmarc_benefit_continuous:"<strong>7x24 全時監測</strong>：我們晝夜不停地追蹤您的網域信譽。",dmarc_benefit_expert:"<strong>專家深度解讀</strong>：我們不只給您圖表，更幫您解讀鑑識數據背後的風險。",dmarc_benefit_consolidated:"<strong>統合管理中心</strong>：在單一入口管理所有發信網域。"},model:{intro1:"> 超越防護：九個維度的資安可驗證真相。",intro2:"一個涵蓋治理、防護、偵測、應變與演進的實戰框架。",l1_title:"治理與風險",l1_desc:"從決策與風險角度建立正確的資安基礎。",l1_d1:"政策與責任",l1_d2:"風險評估",l1_d3:"合規性 (ISO/NIST)",l2_title:"身分與存取",l2_desc:"最小化初始入侵與橫向移動風險。",l2_d1:"AD/IAM 架構",l2_d2:"過度權限分析",l2_d3:"MFA 策略",l3_title:"端點防護",l3_desc:"掌握實際攻擊執行與落地行為。",l3_d1:"EDR/XDR 健康檢查",l3_d2:"行為分析",l3_d3:"無檔案攻擊監控",l4_title:"網路防禦",l4_desc:"識別隱藏通訊與橫向移動軌跡。",l4_d1:"流量分析",l4_d2:"C2 通訊",l4_d3:"橫向移動路徑",l5_title:"應用程式與雲端",l5_desc:"保護現代化攻擊面。",l5_d1:"Web/API 分析",l5_d2:"雲端配置風險",l5_d3:"SaaS 存取審查",l6_title:"威脅情資",l6_desc:"從攻擊者視角強化防禦決策。",l6_d1:"APT 行為分析",l6_d2:"MITRE ATT&CK 對應",l6_d3:"威脅輪廓分析",l7_title:"偵測工程",l7_desc:"讓防禦能力可量化、可驗證。",l7_d1:"規則設計與 QA",l7_d2:"攻擊鏈覆蓋度",l7_d3:"缺口分析",l8_title:"事件響應與 DFIR",l8_desc:"當事件發生時還原完整真相。",l8_d1:"鑑識調查",l8_d2:"時間軸重建",l8_d3:"根因分析",l9_title:"韌性與演進",l9_desc:"將事件轉化為長期的防禦能力。",l9_d1:"事後回顧",l9_d2:"流程優化",l9_d3:"演進藍圖"},footer:{tagline:"捍衛數位邊疆。",copyright:"&copy; 2026 Nine-Security. 系統正常運作中。"},contact:{subtitle:"與我們的鑑識專家聯繫",email_label:"電子郵件頻道",availability_label:"值班狀態",availability_value:"24/7 全年無休鑑識響應",desc:"對於客製化稽核項目、緊急應變或鑑識諮詢，請透過電子郵件與我們聯繫。我們的團隊通常會在 4 個標準工作小時內回覆。"},smtp:{title:"免費 Inbound 郵件安全健診",desc:"低侵入、證據導向。驗證 MX 健康狀況與加密層級，並針對釣魚攻擊常用的偽冒網域進行深度情資對比。",email_label:"輸入公司信箱：",consent:"我授權對此網域的 Inbound MX 進行掃描。",btn_start:"開始健診",verify_title:"需要驗證",verify_desc:"為證明網域控制權，請從您的信箱寄一封空信至：",waiting:"等待驗證郵件中..."},articles:{show_more:"顯示更多 ({n} 篇)",collapse:"收起"},news:{item1_title:"中國駭客開發 DKnife 工具組，針對路由器進行流量劫持與監控",item1_desc:"研究人員揭露活躍多年的 DKnife 框架，中國駭客利用其攻擊邊緣設備並實施中間人攻擊。",item2_title:"CISA 要求聯邦機構撤換淘汰中的邊緣設備以降低網路風險",item2_desc:"美 CISA 發布指令，要求各機構加強設備生命週期管理，移除不再受支援的新網路設備。",item3_title:"Anthropic 揭露 Claude Opus 4.6 在主流開源庫中發現逾 500 個高風險漏洞",item3_desc:"AI 模型 Claude Opus 4.6 展現強大程式碼審計能力，成功識別出數百個先前未知的安全缺陷。"},threat_intel:{detail:"CVE",empty:"暫無威脅情資。",load_error:"無法載入威脅情資。",ransomware:"勒索軟體",source_cisa:"CISA",source_otx:"OTX",heading_cisa:"CISA 已知遭利用漏洞",heading_otx:"OTX 脈動",show_more:"顯示更多 ({n} 筆)",collapse:"收起"},promo_modal:{title:"免費郵件安全健診",desc:"強化您的防禦。使用我們的免費鑑識工具檢查您的電子郵件安全 (SMTP/MX) 狀況。",accept:"立即檢測",close:"繼續瀏覽網站"},arsenal:{host_witness_title:"HostWitness",host_witness_desc:"Windows 單機即時鑑識與活動關聯分析工具。採集並關聯進程、網路與時間軸事件。",host_witness_btn:"前往 GitHub",host_witness_download:"下載 .ZIP",host_witness_hash:"SHA-256 校驗值"},common:{notice_header:"系統通知",notice_btn:"[ 收到 ]"}},jp:{nav:{home:"/ホーム",services:"/サービス",model:"/9層防御モデル",tools:"/アーセナル",news:"/セキュリティニュース",threat_intel:"/脅威インテリジェンス",contact:"/お問い合わせ",back_to_services:"サービス一覧に戻る"},hero:{init:"9SEC 防御プロトコルを初期化中... <span class='status-ok'>[アクティブ]</span>",title:"証拠に基づくセキュリティ",subtitle:"インシデントを検証可能な防御能力へ",desc:"私たちは **フォレンジック** と **証拠** を中心としたセキュリティコンサルティングを提供します。独自の **9層防御モデル** を通じて、企業が攻撃の全体像を把握し、防御のギャップを埋める支援をします。",cta_model:"9層防御モデル",cta_arsenal:"アーセナルを見る"},section:{model:"9層セキュリティ防御モデル",arsenal:"運用アーセナル",news:"セキュリティニュース",intelligence:"脅威インテリジェンス",threat_intel_coming:"脅威情資フィードはここに統合予定です。",smtp:"SMTP_セキュリティ認斷",dmarc_intel:"DMARC_インテリジェンス",services:"9SEC_サービス"},services:{subtitle:"専門的なセキュリティ検査とフォレンジックプロ法ブ",smtp_title:"SMTP メールセキュリティ診断",smtp_desc:"メールインフラの健全性を検証。SPF、DMARC、MTA-STS、暗号化を検査し、リアルタイムのブランドなりすまし・類似ドメイン監視機能を搭載しました。",ad_title:"AD / Azure アイデンティティ監査",ad_desc:"ディレクトリサービス内の過剰な権限アカウント、シャドウ管理者、および安全でない認証パスをスキャンします。",edr_title:"エンドポイント EDR ハイジーン",edr_desc:"ワークステーションフリート全体での EDR カバレッジと動作監視のギャップを特定します。",cta_launch:"プロ法ブを起動",limited_access:"アクセス制限あり",coming_soon:"近日公開",custom_probe:"カスタム・フォレンジック・プロ法ブ",custom_desc:"独自のプロトコルや高価値資産に対する専門的な検査が必要ですか？私たちのチームは、お客様の環境に合わせたカスタムフォレンジックプロ法ブを構築します。",cta_consult:"カスタム監査を依頼",dmarc_title:"DMARC インテリジェンス・モニタ",dmarc_desc:"手動解析を超えたプロフェッショナルなブランド保護。 <ul><li><i class='fa-solid fa-check'></i> <strong>統合ダッシュボード</strong>：全ドメインの送信状態を一元管理。</li><li><i class='fa-solid fa-check'></i> <strong>継続的自動追跡</strong>：RUA経由の24時間365日自動レポート収集。</li><li><i class='fa-solid fa-check'></i> <strong>フォレンジック分析</strong>：不正ななりすまし送信をリアルタイムで特定。</li></ul>",dmarc_trial_tag:"無料試用ツール",dmarc_pro_title:"自動監視プランへの移行",dmarc_pro_desc:"手動アップロードに時間を費やす必要はありません。自動収集と専門家による解析レポートを提供します。",dmarc_benefit_automated:"<strong>自動パイプライン</strong>：XMLファイルの手動処理は不要です。",dmarc_benefit_continuous:"<strong>24時間全時監視</strong>：お客様のドメインの評判を常時追跡します。",dmarc_benefit_expert:"<strong>専門家による解読</strong>：単なるグラフではなく、フォレンジックデータの真意を解説します。",dmarc_benefit_consolidated:"<strong>統合ポータル</strong>：すべてのドメインを一箇所で管理します。"},model:{intro1:"> 単なる防御を超えて：検証可能な真実を追求する9つの次元。",intro2:"ガバナンス、保護、検知、対応、そして進化をカバーする実践的なフレームワーク。",l1_title:"ガバナンス & リスク",l1_desc:"意思決定とリスクの観点から正しいセキュリティ基盤を構築する。",l1_d1:"ポリシー & 責任",l1_d2:"リスク評価",l1_d3:"コンプライアンス (ISO/NIST)",l2_title:"アイデンティティ & アクセス",l2_desc:"初期侵入と横展開のリスクを最小限に抑える。",l2_d1:"AD/IAM アーキテクチャ",l2_d2:"過剰権限分析",l2_d3:"MFA 戦略",l3_title:"エンドポイント保護",l3_desc:"実際の攻撃の実行と着地動作を把握する。",l3_d1:"EDR/XDR ヘルスチェック",l3_d2:"行動分析",l3_d3:"ファイルレス監視",l4_title:"ネットワーク防御",l4_desc:"隠れた通信と横展開を特定する。",l4_d1:"トラフィック分析",l4_d2:"C2 通信",l4_d3:"横展開パス",l5_title:"アプリケーション & クラウド",l5_desc:"現代の攻撃対象領域を保護する。",l5_d1:"Web/API 分析",l5_d2:"クラウド設定リスク",l5_d3:"SaaS アクセスレビュー",l6_title:"脅威インテリジェンス",l6_desc:"攻撃者の視点から防御の意思決定を強化する。",l6_d1:"APT 行動分析",l6_d2:"MITRE ATT&CK マッピング",l6_d3:"脅威プロファイリング",l7_title:"検知エンジニアリング",l7_desc:"防御能力を定量化および検証可能にする。",l7_d1:"ルール設計 & QA",l7_d2:"攻撃チェーンカバレッジ",l7_d3:"ギャップ分析",l8_title:"インシデント対応 & DFIR",l8_desc:"インシデント発生時に完全な真実を復元する。",l8_d1:"フォレンジック調査",l8_d2:"タイムライン再構築",l8_d3:"根本原因分析",l9_title:"レジリエンス & エボリューション",l9_desc:"インシデントを長期的な防御能力に変える。",l9_d1:"インシデント後レビュー",l9_d2:"プロセス最適化",l9_d3:"進化ロードマップ"},footer:{tagline:"デジタルフロンティアを守る。",copyright:"&copy; 2026 Nine-Security. 全システム正常稼働中。"},contact:{subtitle:"フォレンジックコンサルタントに接続",email_label:"Eメールチャンネル",availability_label:"勤務状況",availability_value:"24時間365日のフォレンジックレスポンス",desc:"カスタム監査、インシデント対応、またはフォレンジックに関するお問い合わせは、メールにてご連絡ください。通常、標準業務時間内の4時間以内に返信いたします。"},smtp:{title:"無料 Inbound メールセキュリティ診断",desc:"低侵襲。証拠ベース。MXの健全性と暗号化を確認し、フィッシングに使用される類似ドメインのディープスキャンを実行します。",email_label:"会社のメールアドレス：",consent:"このドメインの Inbound MX スキャンを許可します。",btn_start:"診断を開始",verify_title:"認証が必要です",verify_desc:"ドメイン管理権を証明するため、以下のアドレスに空メールを送信してください：",waiting:"認証メールを待機中..."},articles:{show_more:"もっと見る ({n} 件)",collapse:"閉じる"},news:{item1_title:"中国系ハッカーがDKnifeツールキットを開発、ルーターを標的に通信を傍受",item1_desc:"長年活動しているDKnifeフレームワークが公開。エッジデバイスを攻撃し、中間者攻撃を実行します。",item2_title:"CISA、連邦機関にサポート終了のエッジデバイスの撤去を命令",item2_desc:"米CISA、ネットワークエッジデバイスのライフサイクル管理を強化し、リスクを低減するよう指示。",item3_title:"Claude Opus 4.6、主要なオープンソースライブラリで500以上の高深刻度脆弱性を発見",item3_desc:"Anthropicの最新AIモデル、コード監査能力を発揮し、多数の未知の脆弱性を特定。"},threat_intel:{detail:"CVE",empty:"脅威情資はありません。",load_error:"脅威情資を読み込めません。",ransomware:"ランサムウェア",source_cisa:"CISA",source_otx:"OTX",heading_cisa:"CISA 既知の悪用脆弱性",heading_otx:"OTX パルス",show_more:"もっと見る ({n} 件)",collapse:"閉じる"},promo_modal:{title:"無料セキュリティ診断",desc:"防御を強化しましょう。無料のフォレンジックツールでメールセキュリティ（SMTP/MX）の状態をチェックします。",accept:"今すぐスキャン",close:"サイトの閲覧を続ける"},arsenal:{host_witness_title:"HostWitness",host_witness_desc:"Windows ホスト型ライブフォレンジックおよびアクティビティ相関分析ツール。プロセス、ネットワーク、タイムラインイベントを収集・相関分析します。",host_witness_btn:"GitHub で見る",host_witness_download:"ダウンロード .ZIP",host_witness_hash:"SHA-256 チェックサム"},common:{notice_header:"システム通知",notice_btn:"[ 了解 ]"}}};function t(e,t){const n=localStorage.getItem("9sec_lang")||"en",i=translations[n]||translations.en,s=e.split(".");let a=i;for(const e of s){if(null==a)return t;a=a[e]}return null!=a&&""!==a?a:t}function getArticlesButtonLabel(e,n){return e?t("articles.collapse","Collapse"):t("articles.show_more","Show more ({n})").replace("{n}",n)}function getBrowserLang(){const e=(navigator.language||navigator.userLanguage||"").toLowerCase(),t=navigator.languages?[...navigator.languages]:[e];for(const e of t){const t=(e||"").toLowerCase().split("-")[0];if("zh"===t)return"tw";if("ja"===t)return"jp"}return e.startsWith("zh")?"tw":e.startsWith("ja")?"jp":"en"}const langBtn=document.getElementById("current-lang"),langOptions=document.querySelectorAll(".lang-menu li"),savedLang=localStorage.getItem("9sec_lang")||getBrowserLang();updateLanguage(savedLang),langOptions.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-lang");localStorage.setItem("9sec_lang",t),updateLanguage(t)})});const themeToggleBtn=document.getElementById("theme-toggle"),savedTheme=localStorage.getItem("9sec_theme")||"dark";function updateThemeLabel(e){themeToggleBtn&&(themeToggleBtn.textContent=e.toUpperCase())}function updateLanguage(e){langBtn&&(langBtn.textContent=e.toUpperCase()),document.querySelectorAll("[data-i18n]").forEach(t=>{const n=t.getAttribute("data-i18n").split(".");let i=translations[e];n.forEach(e=>{i&&(i=i[e])}),i&&(t.innerHTML=i)}),document.querySelectorAll("#security-news .articles-more-btn").forEach(e=>{const t="true"===e.dataset.expanded,n=parseInt(e.dataset.remaining,10)||0;e.textContent=getArticlesButtonLabel(t,n)}),document.querySelectorAll(".threat-intel-more-btn").forEach(e=>{const t="true"===e.dataset.expanded,n=parseInt(e.dataset.remaining,10)||0;e.textContent=getThreatIntelButtonLabel(t,n)}),globalNewsList&&globalNewsList.length>0&&renderNews(globalNewsList,newsShowingCount)}async function submitAssessment(){console.log("Starting assessment...");const e=document.getElementById("email-input"),t=document.getElementById("consent-check"),n=document.getElementById("smtp-step-input"),i=document.getElementById("smtp-step-verify"),s=document.getElementById("verification-email"),a=e.value.trim(),o=t.checked,r=validateEmail(a);if(r)return void showNotice(r);if(!o)return void showNotice("Please agree to the authorization terms.");let l,c;try{l=await fetch(`${API_BASE}/api/assessment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,consent:o})})}catch(e){return console.error("API_ERROR",e),void showNotice("Backend Unreachable. Please check your network or try again.")}try{c=await l.json()}catch{return void showNotice("Backend returned invalid JSON.")}if(!c.ok)return void showNotice(`Error: ${c.error}`);currentAssessmentId=c.assessment_id,s.textContent=c.verification_address,n.classList.add("hidden"),i.classList.remove("hidden");const d=document.getElementById("scan-log");d&&(d.innerHTML="",addLog("Session Initialized."),addLog(`Target: ${c.domain}`),addLog("Waiting for inbound verification email...")),pollInterval&&clearInterval(pollInterval),pollInterval=setInterval(()=>checkStatus(currentAssessmentId),2500)}document.documentElement.setAttribute("data-theme",savedTheme),updateThemeLabel(savedTheme),themeToggleBtn&&themeToggleBtn.addEventListener("click",()=>{const e="light"===document.documentElement.getAttribute("data-theme")?"dark":"light";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("9sec_theme",e),updateThemeLabel(e)});const btnStartCheck=document.getElementById("btn-start-check");btnStartCheck&&btnStartCheck.addEventListener("click",submitAssessment);const smtpForm=document.getElementById("smtp-form"),stepInput=document.getElementById("smtp-step-input"),stepVerify=document.getElementById("smtp-step-verify"),stepReport=document.getElementById("smtp-step-report"),verifyEmailCode=document.getElementById("verification-email"),btnCopy=document.getElementById("btn-copy-email"),btnMockVerify=document.getElementById("btn-mock-verify");let currentAssessmentId=null,pollInterval=null;async function startAssessment(e){const t=validateEmail(e);if(t)return void showNotice(t);const n=document.getElementById("consent-check"),i=!!n?.checked;let s,a;try{s=await fetch(`${API_BASE}/api/assessment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,consent:i})})}catch(e){return console.error("API_ERROR",e),void showNotice("Backend unreachable. Check Worker route /api/* and network.")}try{a=await s.json()}catch{return void showNotice(`Invalid backend response (non-JSON). Status: ${s.status} ${s.statusText}`)}if(!s.ok||!a.ok)return console.error("API_FAIL",s.status,a),void showNotice(`Assessment failed: ${a?.error||s.status}`);currentAssessmentId=a.assessment_id,verifyEmailCode.textContent=a.verification_address,stepInput.classList.add("hidden"),stepVerify.classList.remove("hidden");document.getElementById("scan-log").innerHTML='<div class="log-line">> Session started. Waiting for inbound connection...</div>',pollInterval&&clearInterval(pollInterval),pollInterval=setInterval(()=>checkStatus(currentAssessmentId),3e3),await checkStatus(currentAssessmentId)}btnCopy&&btnCopy.addEventListener("click",()=>{navigator.clipboard.writeText(verifyEmailCode.textContent);const e=btnCopy.innerHTML;btnCopy.innerHTML='<i class="fa-solid fa-check"></i>',setTimeout(()=>btnCopy.innerHTML=e,2e3)});const logMessages=["Listening for SMTP connection...","Monitoring MX records for target domain...","Warming up analysis engine...","Checking global blocklists (RBL)...","Verifying TLS handshake capability..."];function addLog(e,t=""){const n=document.getElementById("scan-log"),i=document.createElement("div");for(i.className=`log-line ${t}`,i.textContent=`> ${e}`,n.appendChild(i),n.scrollTop=n.scrollHeight;n.children.length>6;)n.removeChild(n.firstChild)}let isAnalyzing=!1;async function checkStatus(e){let t,n;try{t=await fetch(`${API_BASE}/api/assessment/${encodeURIComponent(e)}`,{method:"GET"})}catch(e){return void console.error("POLL_ERROR",e)}try{n=await t.json()}catch{return void console.error("POLL_INVALID_JSON",t.status)}if(!t.ok||!n.ok)return console.error("POLL_FAIL",t.status,n),addLog(`Error: Connection failed [${t.status}]`,"error"),void clearInterval(pollInterval);if("waiting_email"!==n.status){if("timeout"===n.status)return clearInterval(pollInterval),addLog("Error: Session timed out. No email received.","error"),void showNotice("Session timed out (5 minutes). Please restart the assessment if you wish to try again.");if(("verified"===n.status||"probing"===n.status)&&!isAnalyzing)return isAnalyzing=!0,clearInterval(pollInterval),addLog("Email received! Starting deep analysis...","success"),addLog("Analyzing SPF/DKIM/DMARC alignment...","warn"),setTimeout(()=>addLog("Probing MX host capabilities...","warn"),800),setTimeout(()=>addLog("Verifying MTA-STS policy...","warn"),1600),setTimeout(()=>addLog("Calculating risk score...","warn"),2400),void setTimeout(()=>{addLog("Analysis complete. Generating report...","success");renderReport(n.report||generateMockReport(n.domain)),setTimeout(()=>{stepVerify.classList.add("hidden"),stepReport.classList.remove("hidden"),isAnalyzing=!1},1e3)},3500);if("report_ready"===n.status||"completed"===n.status){clearInterval(pollInterval);renderReport(n.report||generateMockReport(n.domain)),stepVerify.classList.add("hidden"),stepReport.classList.remove("hidden")}}else if(Math.random()>.7){addLog(logMessages[Math.floor(Math.random()*logMessages.length)])}}function generateMockReport(e){return{domain:e,sender_ip:"203.0.113."+Math.floor(255*Math.random()),dns_posture:{spf:"pass",dmarc:"none",dkim:"pass",mta_sts:Math.random()>.5?"enforce":"missing",tls_rpt:Math.random()>.5?"enabled":"missing"},smtp_tls:{starttls:!0,version:"TLS 1.3",cipher:"TLS_AES_256_GCM_SHA384"},risk_level:"Medium",risk_score:65,risk_breakdown:[{item:"DMARC policy is 'none' (Monitoring only)",score:20,severity:"high"},{item:"MTA-STS policy missing or invalid",score:10,severity:"medium"},{item:"SPF lookup count near limit (9/10)",score:5,severity:"low"}]}}function renderReport(e){if(e)try{const t=document.getElementById("report-domain"),n=document.getElementById("report-content"),i=document.getElementById("btn-download-report");t&&(t.textContent=e.domain||"Unknown Domain");const s=e.dns_posture||{},a=e.smtp_tls||{},o=e.risk_score||0,r=e.risk_breakdown||[],l=e.rbl_status||"unchecked",c=e=>"high"===e.severity?"#ff0055":"medium"===e.severity?"#ffaa00":"#666";let d=`\n            <div class="section-title">> Executive Risk Profile (Score: ${o}/100)</div>\n            <div class="risk-container">\n                ${r.map(e=>`\n                    <div class="risk-item" style="border-left-color: ${c(e)};">\n                        <span>${escapeHtml(String(null!=e.item?e.item:""))}</span>\n                        <span class="value pass">+${e.score}</span>\n                    </div>\n                `).join("")}\n            </div>\n\n            <div class="section-title">> Authentication Infrastructure</div>\n            <div class="grid">\n                <div class="card"><div class="label">Origin MTA Node</div><div class="value">${escapeHtml(String(e.sender_ip||"Generic Postfix/Exim"))}</div></div>\n                <div class="card"><div class="label">Network Latency</div><div class="value ${parseFloat(e.transport_time)>5?"warn":"pass"}">${escapeHtml(String(e.transport_time||"N/A"))}</div></div>\n                <div class="card">\n                    <div class="label">SPF Governance</div>\n                    <div class="value ${getStatusClass(s.spf)}">${(s.spf||"MISSING").toUpperCase()}</div>\n                    ${"warn"===s.spf?'<div class="gap-warning">⚠️ RFC 7208 Complexity Limit Exceeded</div>':""}\n                </div>\n                <div class="card">\n                    <div class="label">DMARC Enforcement</div>\n                    <div class="value ${getStatusClass(s.dmarc)}">${(s.dmarc||"NONE").toUpperCase()}</div>\n                    ${s.dmarc_raw&&s.dmarc_raw.includes("rua=")?'<div class="gap-warning">⚠️ Potential Data Exfiltration Path via RUA</div>':""}\n                </div>\n                <div class="card"><div class="label">DNSSEC Integrity</div><div class="value ${getStatusClass(s.dnssec)}">${(s.dnssec||"FAIL").toUpperCase()}</div></div>\n                <div class="card"><div class="label">RBL Reputation</div><div class="value ${"fail"===l?"fail":"pass"}">${"fail"===l?"BLACKLISTED":"CLEAN"}</div></div>\n            </div>\n\n            <div class="section-title">> Advanced Security Protocols</div>\n            <div class="grid">\n                <div class="card">\n                    <div class="label">MTA-STS Handshake</div>\n                    <div class="value ${getStatusClass(s.mta_sts)}">${(s.mta_sts||"MISSING").toUpperCase()}</div>\n                    ${"missing"===s.mta_sts&&"None"!==s.mta_sts_raw?'<div class="gap-warning">⚠️ Policy Handshake Integrity Failed</div>':""}\n                </div>\n                <div class="card"><div class="label">TLS Reporting (RPT)</div><div class="value ${getStatusClass(s.tls_rpt)}">${(s.tls_rpt||"MISSING").toUpperCase()}</div></div>\n                <div class="card"><div class="label">BIMI Brand Indicator</div><div class="value ${getStatusClass(s.bimi)}">${(s.bimi||"MISSING").toUpperCase()}</div></div>\n                <div class="card"><div class="label">Transport Encryption</div><div class="value pass">${escapeHtml(String(a.version||"TLS 1.3 (Verified)"))}</div></div>\n            </div>\n\n            <div class="cta-box">\n                <h3>Want the Technical Forensic Report?</h3>\n                <p>Our backend has identified specific RFC violations and policy handshake failures.</p>\n                <p>Contact <strong>consult@nine-security.com</strong> to unlock the full technical diagnostic and remediation guide.</p>\n            </div>\n\n            <div class="report-footer">\n                CONFIDENTIAL - GENERATED BY NINE-SECURITY.INC FORENSIC CLUSTER<br>\n                &copy; 2026 Nine-Security Team. All Systems Operational.\n            </div>\n        `;window.currentReportData=e,n&&(n.innerHTML=d),i&&i.classList.remove("hidden")}catch(e){console.error("Rendering failed:",e);const t=document.getElementById("report-content");t&&(t.innerHTML=`<div class="error">Report rendering error: ${escapeHtml(String(e&&e.message||"Unknown error"))}</div>`)}else console.error("No report data available")}const btnResetCheck=document.getElementById("btn-reset-check");function getReportHtml(e){if(!e)return"";const t=escapeHtml(String(e.domain||"unknown")),n=e.dns_posture||{},i=Number(e.risk_score)||0;return`\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset="UTF-8">\n    <title>9Sec Security Report - ${t}</title>\n    <style>\n        :root { --green: #00ff41; --fail: #ff0055; --warn: #ffaa00; --bg: #0a0a0a; --card: #111; --border: #333; --text: #e0e0e0; }\n        body { background: var(--bg); color: var(--text); font-family: 'Courier New', Courier, monospace; padding: 40px; max-width: 800px; margin: 0 auto; line-height: 1.6; }\n        .header { border-bottom: 2px solid var(--green); padding-bottom: 20px; margin-bottom: 30px; }\n        .header h1 { color: var(--green); margin: 0; letter-spacing: 2px; }\n        .section-title { color: var(--green); margin: 30px 0 15px; font-size: 1.1rem; border-left: 4px solid var(--green); padding-left: 15px; text-transform: uppercase; }\n        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }\n        .card { background: var(--card); border: 1px solid var(--border); padding: 15px; position: relative; }\n        .label { color: #666; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px; }\n        .value { font-size: 1.1rem; font-weight: bold; }\n        .risk-item { display: flex; justify-content: space-between; padding: 12px; background: rgba(255,255,255,0.03); border: 1px solid var(--border); margin-bottom: 8px; }\n        .cta-box { border: 1px solid var(--green); padding: 25px; margin-top: 40px; text-align: center; background: rgba(0,255,65,0.05); }\n        .footer { margin-top: 50px; text-align: center; color: #444; font-size: 0.8rem; border-top: 1px solid #222; padding-top: 20px; }\n        @media print { body { background: #fff !important; color: #000 !important; } .card, .risk-item { border: 1px solid #ddd !important; } }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>NINE-SECURITY // ASSESSMENT_LOG</h1>\n        <p>Target Domain: <span style="color: var(--green);">${t}</span></p>\n        <p style="font-size: 11px; color: #666;">Generated: ${(new Date).toLocaleString()}</p>\n    </div>\n\n    <div class="section-title">> EXECUTIVE_RISK_PROFILE [Score: ${i}/100]</div>\n    <div class="risk-container">\n        ${(e.risk_breakdown||[]).map(e=>`\n            <div class="risk-item" style="border-left: 5px solid ${"high"===e.severity?"#ff0055":"medium"===e.severity?"#ffaa00":"#444"};">\n                <span>${escapeHtml(String(null!=e.item?e.item:""))}</span>\n                <span style="color: var(--green); font-weight: bold;">+${Number(e.score)||0}</span>\n            </div>\n        `).join("")}\n    </div>\n\n    <div class="section-title">> AUTH_INFRASTRUCTURE_PROBE</div>\n    <div class="grid">\n        <div class="card"><div class="label">Origin MTA Node</div><div class="value">${escapeHtml(String(e.sender_ip||"Generic MTA"))}</div></div>\n        <div class="card"><div class="label">Network Latency</div><div class="value">${escapeHtml(String(e.transport_time||"N/A"))}</div></div>\n        <div class="card"><div class="label">SPF Governance</div><div class="value" style="color: ${"pass"===getStatusClass(n.spf)?"var(--green)":"var(--fail)"}">${String(n.spf||"MISSING").toUpperCase()}</div></div>\n        <div class="card"><div class="label">DMARC Enforcement</div><div class="value" style="color: ${"pass"===getStatusClass(n.dmarc)?"var(--green)":"var(--warn)"}">${String(n.dmarc||"NONE").toUpperCase()}</div></div>\n    </div>\n\n    <div class="section-title">> ADVANCED_SECURITY_PROTOCOLS</div>\n    <div class="grid">\n        <div class="card"><div class="label">MTA-STS Handshake</div><div class="value" style="color: ${"pass"===getStatusClass(n.mta_sts)?"var(--green)":"var(--fail)"}">${String(n.mta_sts||"MISSING").toUpperCase()}</div></div>\n        <div class="card"><div class="label">Transport Encryption</div><div class="value">${escapeHtml(String(e.smtp_tls?.version||"TLS 1.3"))}</div></div>\n        <div class="card"><div class="label">TLS Reporting (RPT)</div><div class="value" style="color: ${"pass"===getStatusClass(n.tls_rpt)?"var(--green)":"var(--fail)"}">${String(n.tls_rpt||"MISSING").toUpperCase()}</div></div>\n        <div class="card"><div class="label">Brand Indicator (BIMI)</div><div class="value" style="color: ${"pass"===getStatusClass(n.bimi)?"var(--green)":"var(--fail)"}">${String(n.bimi||"MISSING").toUpperCase()}</div></div>\n    </div>\n\n    <div class="cta-box">\n        <h3 style="color: var(--green); margin-top: 0;">FORENSIC DIAGNOSTIC REQUIRED</h3>\n        <p>Our backend identified RFC violations and policy gaps.</p>\n        <p style="font-weight: bold;">consult@nine-security.com</p>\n    </div>\n\n    <div class="footer">\n        CONFIDENTIAL - CUSTODIAN: NINE-SECURITY.INC CLUSTER<br>\n        &copy; 2026 Nine-Security Team. All Systems Operational.\n    </div>\n</body>\n</html>`}btnResetCheck&&btnResetCheck.addEventListener("click",()=>{const e=document.getElementById("smtp-step-report"),t=document.getElementById("smtp-step-verify"),n=document.getElementById("smtp-step-input"),i=document.getElementById("email-input"),s=document.getElementById("scan-log"),a=document.getElementById("report-content");e&&e.classList.add("hidden"),t&&t.classList.add("hidden"),n&&n.classList.remove("hidden"),currentAssessmentId=null,pollInterval&&clearInterval(pollInterval),i&&(i.value=""),s&&(s.innerHTML=""),a&&(a.innerHTML="");const o=document.getElementById("consent-check");o&&(o.checked=!1)});const btnDownloadReport=document.getElementById("btn-download-report");function injectPromoModal(){document.body.insertAdjacentHTML("beforeend",'\n    <div id="promo-modal" class="modal-overlay">\n        <div class="modal-content">\n            <button class="modal-close-x" id="btn-promo-close" aria-label="Close"><i class="fa-solid fa-xmark"></i></button>\n            <i class="fa-solid fa-envelope-shield modal-icon"></i>\n            <h2 class="modal-title" data-i18n="promo_modal.title">FREE SECURITY ASSESSMENT</h2>\n            <p class="modal-desc" data-i18n="promo_modal.desc">Check your Email Security (SMTP/MX) status for free.</p>\n            <div class="modal-actions">\n                <a href="smtp-check.html" class="btn primary-btn" id="btn-promo-accept">\n                    <i class="fa-solid fa-radar"></i> <span data-i18n="promo_modal.accept">Check Now</span>\n                </a>\n            </div>\n        </div>\n    </div>\n    ');const e=document.getElementById("promo-modal"),t=document.getElementById("btn-promo-close"),n=document.getElementById("btn-promo-accept");e.style.display="flex",e.offsetWidth,e.classList.add("show");t&&t.addEventListener("click",()=>{e.classList.remove("show"),setTimeout(()=>{e.style.display="none",e.remove()},300),sessionStorage.setItem("9sec_promo_seen","true")}),n&&n.addEventListener("click",()=>{sessionStorage.setItem("9sec_promo_seen","true")});updateLanguage(localStorage.getItem("9sec_lang")||"en")}btnDownloadReport&&btnDownloadReport.addEventListener("click",()=>{const e=window.currentReportData;if(!e)return;const t=e.domain||"unknown",n=String(t).replace(/[^a-zA-Z0-9._-]/g,"_").slice(0,200)||"domain",i=getReportHtml(e);if(!i)return;const s=new Blob([i],{type:"text/html"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`9Sec_Security_Report_${n}.html`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(a),document.body.removeChild(o)}),document.addEventListener("DOMContentLoaded",()=>{const e=sessionStorage.getItem("9sec_promo_seen");window.location.pathname.includes("smtp-check.html")||e||setTimeout(injectPromoModal,500)});const backToTopBtn=document.getElementById("back-to-top");function showNotice(e){let t=document.getElementById("notice-system-overlay");if(!t){const e='\n        <div id="notice-system-overlay" class="notice-overlay">\n            <div class="notice-box">\n                <div class="notice-header">\n                    <i class="fa-solid fa-terminal"></i> <span data-i18n="common.notice_header">SYSTEM_NOTIFICATION</span>\n                </div>\n                <div id="notice-system-body" class="notice-body"></div>\n                <div class="notice-footer">\n                    <button class="notice-btn" id="btn-notice-ack" data-i18n="common.notice_btn">[ ACKNOWLEDGE ]</button>\n                </div>\n            </div>\n        </div>\n        ';document.body.insertAdjacentHTML("beforeend",e),t=document.getElementById("notice-system-overlay"),document.getElementById("btn-notice-ack").addEventListener("click",()=>{t.classList.remove("show"),setTimeout(()=>{t.style.display="none"},300)}),window.addEventListener("keydown",e=>{"Enter"===e.key&&t.classList.contains("show")&&document.getElementById("btn-notice-ack").click()})}document.getElementById("notice-system-body").textContent=e,t.style.display="flex",t.offsetWidth,t.classList.add("show");const n=localStorage.getItem("9sec_lang")||"en",i=t.querySelector('[data-i18n="common.notice_header"]'),s=t.querySelector('[data-i18n="common.notice_btn"]');translations[n]&&(i&&(i.textContent=translations[n].common?.notice_header||"SYSTEM_NOTIFICATION"),s&&(s.textContent=translations[n].common?.notice_btn||"[ ACKNOWLEDGE ]"))}backToTopBtn&&(window.addEventListener("scroll",()=>{window.scrollY>300?backToTopBtn.classList.add("show"):backToTopBtn.classList.remove("show")}),backToTopBtn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),document.addEventListener("visibilitychange",()=>{document.hidden});